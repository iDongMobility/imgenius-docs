
import useBaseUrl from '@docusaurus/useBaseUrl';

在imgenius企业移动现场作业管理软件中，使用im解决方案开发中心中的**业务流程管理器**来创建**业务流程**。**业务流程**是对企业一系列与现场作业关联的关键业务活动运转过程的描述。通过**业务流程**可以说明工作流程，还可以明确业务活动的参与者。活动的参与者可以使用绝对用户、相对用户和角色来定义。**业务流程**是由一系列的活动构成，由活动工具箱中的活动块（代表活动的图标）表示。一个**业务流程**必须具备“开始”和“结束”活动，也通常具有“执行”活动。

## 配置业务流程

* 在**导航栏→业务流程管理器**内右键**演示-业务流程**，在快捷菜单中即可完成**业务流程**的新建、删除、重命名、复制、粘贴、排序、验证、导入和导出操作。

  <img alt=" " src={useBaseUrl('docimg/业务流程1.png')} />

## 新建业务流程

* 在**导航栏→业务流程管理器→选择演示-业务流程**，右键，在快捷菜单栏中选择新建，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程2.png')} />

* 选中新流程1，在右边属性栏修改属性，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程3.png')} />

  * **流程名**：流程的名称。
  * **流程描述**：描述信息。

## 活动工具箱

* 活动工具箱一共包含初始活动、业务活动、逻辑活动三个模块，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程15.png')} />

### 初始活动

* **业务流程**中的初始活动，是产生**作业组**的活动。

<img alt=" " src={useBaseUrl('docimg/业务流程6.png')} />：在im企业运营中心对**作业组**应用“即时创建”的计划活动。

<img alt=" " src={useBaseUrl('docimg/业务流程7.png')} />：在im企业运营中心对**作业组**应用“计划”的计划活动，系统自动按照创建规则自动创建**作业组**。  

### 业务活动

<img alt=" " src={useBaseUrl('docimg/业务流程8.png')} />：在手持终端上执行作业组的活动。  

<img alt=" " src={useBaseUrl('docimg/业务流程9.png')} />：要求在im企业运营中心进行审核操作的活动。  

### 逻辑活动

<img alt=" " src={useBaseUrl('docimg/业务流程10.png')} />：业务流程的起点。  

<img alt=" " src={useBaseUrl('docimg/业务流程11.png')} />：业务流程的终点。  

<img alt=" " src={useBaseUrl('docimg/业务流程12.png')} />：业务流程的逻辑条件。  

<img alt=" " src={useBaseUrl('docimg/业务流程13.png')} />：业务流程中构造分支结构。  

<img alt=" " src={useBaseUrl('docimg/业务流程14.png')} />：业务流程中将多个逻辑条件合并到一起。  

## 配置新建流程

* 选中一个流程，右击，在快捷菜单栏中选择配置，在主工作区出现配置流程界面。

* **示例**：选中“巡检流程”，双击或者右击，在快捷菜单栏中选择配置，在主工作区出现“巡检流程”的配置界面，如下图：

  <img alt=" " src={useBaseUrl('docimg/业务流程4.png')} />

  <img alt=" " src={useBaseUrl('docimg/业务流程5.png')} />

* 点击右边**属性栏-活动工具箱**，添加一个“开始”活动，将活动模块直接拖动至配置界面，分别拖动“开始”、“计划”、“创建”、“执行”、“审核”、“结束”几个模块，构造一个基本的巡检流程，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程16.png')} />

* 调整活动块的高度和宽度，在主工作区→流程配置窗口内，单击鼠标左键选中活动块，拖动活动块的四角至适宜的位置松开鼠标来改变高度和宽度。  
* 调整活动块的位置，在主工作区→流程配置窗口内，直接用光标拖动活动块即可。

### 活动块的链接

* 在主工作区→我的流程配置页面内，将光标停驻在“开始”活动块边线中点处的小方格，看到光标及活动块呈<img alt=" " src={useBaseUrl('docimg/业务流程17.png')} />，按住鼠标左键，拖动黑色十字光标至“计划”活动块边线中点小方格处，看到光标及活动块呈<img alt=" " src={useBaseUrl('docimg/业务流程18.png')} /> ，松开鼠标左键，活动块间出现箭头线将两个活动块连接。
如图所示搭建链接：

  <img alt=" " src={useBaseUrl('docimg/业务流程19.png')} />

  <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**：搭建条件活动连接时，注意条件块两条OUT箭头线的值。

  * **True**——条件表达式结果为真
  * **False**——条件表达式结果为假
  * 可以通过OUT箭头线的属性栏更改。

### 删除活动块和链接

* 选中活动块或链接，之间按“Delete”键或者右键选择“Delete Del”删除，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程20.png')} />

### 配置活动块的参与者

* **参与者**属性用于配置在此流程中能够参与实际业务活动的人员。
* **参与者**属性下有人员和角色两种配置模式，用户可同时选取两种模式，也可配置单一模式。

#### 使用绝对人员配置参与者

* 绝对人员配置可以指定任意的固定用户为该活动的参与者,你指定的用户有权进行相关的活动。  
在参与者属性下勾选人员，出现人员配置框。勾选该活动指定参与人员，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程21.png')} />

  <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意：**

  * 绝对用户配置的条件类型有两种：等于和不等于。
  * 使用绝对用户配置在用户变更时需要重新配置。

#### 使用相对人员配置参与者

* 相对**人员**配置可以使用某一活动提交者（活动的实际执行人）或活动提交者的经理（活动实际执行人的经理）来指定该活动的参与者。

  <img alt=" " src={useBaseUrl('docimg/业务流程22.png')} />

  <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意：**

  * 默认活动为当前活动的前一活动。
  * 当前活动的前一活动为开始活动时不能使用默认活动;

  <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**：选择人员对话框内，@活动提交者和@活动提交者.经理可同时配置。

#### 使用角色配置参与者

* **角色**配置可以指定**角色**为该活动的参与者，角色由**组织单元、岗位及业务范畴**组成。
* 在参与者属性下勾选角色，进入选择角色对话框，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程23.png')} />

* 点击添加，新建一个角色，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程24.png')} />

1. 配置角色的**组织单元**，点击**组织单元**的条件类型，选择一个条件。

   <img alt=" " src={useBaseUrl('docimg/业务流程25.png')} />

   * **等于**：角色是所选组织单元内成员，不含所选组织单元子级组织单元内成员。
   * **不等于**：角色是除所选组织单元外的其他成员（包含所选组织单元子级组织单元）。
   * **包含**：角色是所选组织单元及父级组织单元内成员。
   * **属于**：角色是所选组织单元及子级组织单元内成员。

   * 单击对话框右侧属性卡**组织单元**扩展按钮<img alt=" " src={useBaseUrl('docimg/扩展符号图.png')} />进入选择**组织单元**对话框，在选择**组织单元**选择框汇总选择**角色**的所属**组织单元**，单击**确定**完成。

* 绝对**组织单元**

  * 绝对**组织单元**可以指定任意的固定**组织单元**为该角色的**组织单元**。

    <img alt=" " src={useBaseUrl('docimg/业务流程26.png')} />

* 相对**组织单元**

  * 相对**组织单元**可以@**作业组的组织单元**，选择应用**业务流程**的**作业组**所属**组织单元**为该角色相关**组织单元**，也可以@**活动提交者的组织单元**，即选取某一活动提交者的**组织单元**为该角色所属**组织单元**。

    <img alt=" " src={useBaseUrl('docimg/业务流程27.png')} />

    <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**：角色的**组织单元**具有唯一性。

2. 配置角色的**业务范畴**，点击**业务范畴**的条件类型，选择一个条件。

   <img alt=" " src={useBaseUrl('docimg/业务流程28.png')} />

   * **等于**：角色的**业务范畴**是所选**业务范畴类别**内全部**业务范畴**或所选**业务范畴**。
   * **不等于**：角色的**业务范畴**是除所选**业务范畴类别**、**业务范畴**外的其他任何**业务范畴**。
   * **包含**：角色的**业务范畴**里含有所选**业务范畴类别、业务范畴**。单一类别的**业务范畴**一定包含了同时勾选了该**业务范畴**以及另外类别的**业务范畴**。
   * **属于**：角色的**业务范畴**是所选**业务范畴类别**内任一**业务范畴**或所选**业务范畴**。包含关系的反面就是属于关系，A包含B意味着B属于A。

   * 单击对话框右侧属性卡**业务范畴**扩展按钮<img alt=" " src={useBaseUrl('docimg/扩展符号图.png')} />进入选择**业务范畴**对话框，在**业务范畴**列表下选择一个**业务范畴**角色的所属**业务范畴**，单击**确定**完成。

* 绝对**业务范畴**

  * 绝对**业务范畴**可以指定任意的固定**业务范畴**为该角色的**业务范畴**。

    <img alt=" " src={useBaseUrl('docimg/业务流程29.png')} />

* 相对业务范畴

  * 相对**业务范畴**可以勾选@**作业组的业务范畴**，选择**作业组**所属**业务范畴**为该角色所属**业务范畴**，也可以勾选@**活动提交者的业务范畴**，选取某一活动提交者的**业务范畴**为该角色所属**业务范畴**。

    <img alt=" " src={useBaseUrl('docimg/业务流程30.png')} />

    <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**:选择**业务范畴**对话框内，用户可同时组合配置勾选**业务范畴类别**、**业务范畴**以及@**作业组的业务范畴**、@**活动提交者的业务范畴**。该选择指定了这些不同类别的**业务范畴**的交集。

3. 配置角色的**岗位**，点击**岗位**的条件类型，选择一个条件。

   <img alt=" " src={useBaseUrl('docimg/业务流程31.png')} />

   * **等于**—角色的**岗位**是所选**岗位**。
   * **不等于**—角色的**岗位**是除所选**岗位**外的其他任何**岗位**。

   * 单击对话框右侧属性卡**岗位**扩展按钮<img alt=" " src={useBaseUrl('docimg/扩展符号图.png')} />进入选择**岗位**对话框，在**岗位**列表下选择一个**岗位**为角色所属**岗位**，单击**确定**完成。

* 绝对**岗位**  

  * 绝对**岗位**可以指定任意的固定**岗位**为该角色的**岗位**。

    <img alt=" " src={useBaseUrl('docimg/业务流程32.png')} />

* 相对**岗位**  

  * 相对岗位可以勾选@**活动提交者的岗位**，即选取某一活动提交者的**岗位**为该角色所属**岗位**。

    <img alt=" " src={useBaseUrl('docimg/业务流程33.png')} />

    <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**:角色的岗位具有唯一性。

    <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**:角色配置可根据用户需要选择是否配置角色的**组织单元、业务范畴、岗位**，或者组合配置，只要配置结果可以满足角色职责定义需要。

  * 用户可根据需要继续添加或删除角色，添加后的配置同上，单击确定完成。

    <img alt=" " src={useBaseUrl('docimg/业务流程34.png')} />

  * 配置完成保存<img alt=" " src={useBaseUrl('docimg/保存.png')} />后关闭。

<img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**:在使用角色定义参与者时可以定义多个角色。

#### 使用组合条件配置参与者

* 在**组合条件**右侧点击扩展按钮<img alt=" " src={useBaseUrl('docimg/扩展符号图.png')} />，出现编辑组合条件框。根据需求配置人员组合条件，如图：

  <img alt=" " src={useBaseUrl('docimg/业务流程35.png')} />

#### 配置活动业务规则

* 在**业务规则**中如下属性：

  <img alt=" " src={useBaseUrl('docimg/流程管理器4101.png')} />

  * **活动结束事件**：为该执行活动结束时配置事件
  * **插入函数**：流程后函数的向导，在流程活动属性中点击插入函数
  * **超时(分钟)**：设置该执行活动超时的时长
  * **周期发送消息**：周期发送该活动的消息提醒
  * **共同执行人**：勾上此项，终端执行作业组后会提示添加共同执行人
  * **完成百分比（%）**：设置该执行活动的完成百分比

* 在流程活动属性中点击插入函数，可以选择要用到的流程函数，支持直接搜索，并且也对函数进行了分类，点击函数会有简单的说明。关联了在线文档，查看详细说明点击在线帮助即可。

  <img alt=" " src={useBaseUrl('docimg/lchhs40451.png')} />


### 配置条件活动块的表达式

* 对于条件活动，其属性中还需要配置**条件表达式**。

  <img alt=" " src={useBaseUrl('docimg/业务流程36.png')} />

* 编辑表达式框用以配置该条件活动块的**逻辑表达式**。点击编辑表达式框的扩展<img alt=" " src={useBaseUrl('docimg/扩展符号图.png')} />按钮，进入条件表达式配置对话框。

  <img alt=" " src={useBaseUrl('docimg/业务流程37.png')} />

* 在条件表达式配置对话框内，点击**名称**框，在下拉选择框中选取表达式条件类型，可选的表达式类型有：最高**例外等级**、前一个业务活动状态、完成状态、**组织单元**和**业务范畴**。

* 点击**符号框**，在下拉选择框中选取表达式运算符号，根据所选表达式条件类型，运算符号列表有所区别；

* 点击**值**框，在下拉选择框中选取表达式的值类型，根据所选表达式条件类型，值类型列表显示对应的**列表项**；单击**确定**完成。

* 名称、符号和值的关系如下表：

  <img alt=" " src={useBaseUrl('docimg/条件列表.png')} />

  <img alt=" " src={useBaseUrl('docimg/示例.png')} />**示例**：最高例外等级>=注意

  <img alt=" " src={useBaseUrl('docimg/业务流程38.png')} />

  <img alt=" " src={useBaseUrl('docimg/示例.png')} />**示例**：前一个业务活动状态=批准

  <img alt=" " src={useBaseUrl('docimg/业务流程39.png')} />

### 重命名活动块

* 配置活动块通用属性

  * 在主工作区→流程配置窗口内，单击选中一个活动块，在属性栏出现该活动块的活动属性选项卡，在活动名文本框中可修改该活动名称。

    <img alt=" " src={useBaseUrl('docimg/注意.png')} />**注意**：来自于活动文本框为只读属性，用以显示当前活动名所属活动。

    <img alt=" " src={useBaseUrl('docimg/业务流程40.png')} />
