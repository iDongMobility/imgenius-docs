
import useBaseUrl from '@docusaurus/useBaseUrl';

发布时间：待发布

## 增加的功能

1. [PBIN1476：作业组支持表单模式](#pbin1476作业组支持表单模式)
1. [PBIN3222：网页端配置外部链接时可以设置为使用新Tab页打开](#pbin3222网页端配置外部链接时可以设置为使用新tab页打开)
1. [PBIN3223：使用自己邮件服务器时发件人邮箱和账户可以分开设置](#pbin3223使用自己邮件服务器时发件人邮箱和账户可以分开设置)
1. [PBIN3231：移动工作站新界面](#pbin3231移动工作站新界面)
1. [PBIN3240：作业组特殊视图，如果作业项没有输入值，则根据状态来设定显示值](#pbin3240作业组特殊视图如果作业项没有输入值则根据状态来设定显示值)
1. [PBIN3246：项目属性支持根据流程的活动来控制权限](#pbin3246项目属性支持根据流程的活动来控制权限)
1. [PBIN3308：增加同步后语音提示](#pbin3308增加同步后语音提示)
1. [PBIN3335：资产属性直接支持连接OPC-DA/UA-Server、MQTT](#pbin3335资产属性直接支持连接opc-daua-servermqtt)
1. [PBIN3387：增加修改作业组的名称与描述流程后函数，同时增加插入流程后函数向导](#pbin3387增加修改作业组的名称与描述流程后函数同时增加插入流程后函数向导)
1. [PBIN3394：流程后函数支持运行脚本](#pbin3394流程后函数支持运行脚本)
1. [PBIN3398：终端主页支持自定义](#pbin3398终端主页支持自定义)
1. [PBIN3454：计划显示作业组完成状态和是否归档](#pbin3454计划显示作业组完成状态和是否归档)
1. [PBIN3463：人员、资产和组织单元资质管理，同时支持附件](#pbin3463人员资产和组织单元资质管理同时支持附件)
1. [PBIN3492：作业组模板可以设置计划提前创建的时间](#pbin3492作业组模板可以设置计划提前创建的时间)
1. [PBIN3506：终端支持蓝牙电子秤](#pbin3506终端支持蓝牙电子秤)
1. [PBIN3507：终端支持打印](#pbin3507终端支持打印)
1. [PBIN3508：终端物料查询扩展页面](#pbin3508终端物料查询扩展页面)
1. [PBIN3509：终端库存操作支持选择同时选择多个物料](#pbin3509终端库存操作支持选择同时选择多个物料)
1. [PBIN3510：优化终端作业组执行页面](#pbin3510优化终端作业组执行页面)
1. [PBIN3511：终端审核类消息跳转支持跳转到审核或详细](#pbin3511终端审核类消息跳转支持跳转到审核或详细)
1. [PBIN3515：终端库操作物料模糊搜索不区分大小写](#pbin3515终端库操作物料模糊搜索不区分大小写)
1. [PBIN3516：终端支持自动登录](#pbin3516终端支持自动登录)
1. [PBIN3517：作业组模板增加预设时长，计划时缺省使用此时长](#pbin3517作业组模板增加预设时长计划时缺省使用此时长)
1. [PBIN3580：审核支持作业组模板名称为查询条件](#pbin3580审核支持作业组模板名称为查询条件)
1. [PBIN3581：作业组维护页面作业组名称修改为模糊搜索](#pbin3581作业组维护页面作业组名称修改为模糊搜索)
1. [PBIN3595：内置作业组属性扩展KPI的配置和管理](#pbin3595内置作业组属性扩展kpi的配置和管理)
1. [PBIN3599：修改资产属性具有权限控制](#pbin3599修改资产属性具有权限控制)
1. [PBIN3602：重构网页端图标选择对话框，同时增加更多的图标](#pbin3602重构网页端图标选择对话框同时增加更多的图标)
1. [PBIN3606：支持智能摄像头，实现无感考勤，实时感知人员状态](#pbin3606支持智能摄像头实现无感考勤实时感知人员状态)
1. [PBIN3643：SDC增加新建智能设备和数据源菜单](#pbin3643sdc增加新建智能设备和数据源菜单)
1. [PBIN3659：优化物料选择窗口](#pbin3659优化物料选择窗口)
1. [PBIN3660：库操作和导入支持多存储区域](#pbin3660库操作和导入支持多存储区域)
1. [PBIN3680：以值为筛选条件的报表查询优化](#pbin3680以值为筛选条件的报表查询优化)
1. [PBIN3683：作业组属性报表支持特殊视图的批量导出](#pbin3683作业组属性报表支持特殊视图的批量导出)
1. [PBIN3697：增强系统安全性](#pbin3697增强系统安全性)
1. [PBIN3716：终端和Web进入JSON新建或编辑窗口时光标自动选中第一项](#pbin3716终端和web进入json新建或编辑窗口时光标自动选中第一项)
1. [PBIN3719：资产和人员的导入工具集成到SDC中](#pbin3719资产和人员的导入工具集成到sdc中)
1. [PBIN3720：终端自定义页面支持显示后脚本](#pbin3720终端自定义页面支持显示后脚本)
1. [PBIN3721：报表支持把条件直接设置到工具条上](#pbin3721报表支持把条件直接设置到工具条上)
1. [PBIN3722：Web图片类型的作业组属性支持缩略图显示](#pbin3722web图片类型的作业组属性支持缩略图显示)
1. [PBIN3723：EOC作业树图片预览时支持缩放](#pbin3723eoc作业树图片预览时支持缩放)
1. [PBIN3724：EOC所有三个点的链接地方改成详情](#pbin3724eoc所有三个点的链接地方改成详情)
1. [PBIN3725：EOC新建或编辑物料时，物料号和物料名有重复直接提示](#pbin3725eoc新建或编辑物料时物料号和物料名有重复直接提示)
1. [PBIN3726：资产总览活动作业和历史作业支持例外等级筛选](#pbin3726资产总览活动作业和历史作业支持例外等级筛选)
1. [PBIN3727：排班表支持批量删除](#pbin3727排班表支持批量删除)
1. [PBIN3728：记录报表跳转前选中行，返回时自动选中](#pbin3728记录报表跳转前选中行返回时自动选中)
1. [PBIN3770：增加启用更新资产属性消息的配置](#pbin3770增加启用更新资产属性消息的配置)
1. [PBIN3771：增加批量更新资产属性的接口，同时指定是否产生变化消息](#pbin3771增加批量更新资产属性的接口同时指定是否产生变化消息)
1. [PBIN3772：所有内置报表、库存等支持配置为另外的扩展功能，从而实现相同功能定义不同的隐藏列和列显示名](#pbin3772所有内置报表库存等支持配置为另外的扩展功能从而实现相同功能定义不同的隐藏列和列显示名)
1. [PBIN3775：支持下载作业组特殊视图的API](#pbin3775支持下载作业组特殊视图的api)
1. [PBIN3804：EOC布局调整](#pbin3804eoc布局调整)
1. [PBIN3828：作业组属性支持审核完成前脚本](#pbin3828作业组属性支持审核完成前脚本)
1. [PBIN3833：产品内部扩展统一部署和运行](#pbin3833产品内部扩展统一部署和运行)
1. [PBIN3846：终端同步增加进度条和完成百分比显示](#pbin3846终端同步增加进度条和完成百分比显示)
1. [PBIN3863：资产属性支持配置不保存历史](#pbin3863资产属性支持配置不保存历史)

## 修复的问题

1. BugN3236：终端作业组属性个数超过1时，多行文本的属性值显示一行
1. BugN3244：项目中列表属性在摘要视图中显示为ID
1. BugN3252：项目中保存的开始时间早于当前时间的作业组，在项目开始后会自动发布
1. BugN3257：库存的SQLScript查询不起作用
1. BugN3263：静默同步在有些场景下错误
1. BugN3267：IE浏览器下新建计划的弹框中时长显示NaN
1. BugN3302：SDC用户复制失败
1. BugN3304：在作业树页面切换视图再返回作业树视图时，点击图片会跳转到新页面
1. BugN3313：库操作物料的值Word视图中显示不正确
1. BugN3316：终端库操作时选两个或以上的物料点击确定再增加，会出现空白行
1. BugN3317：库存表中项信息数量可以超过库存数量
1. BugN3321：重新计划退回会导致后续应该创建的计划在一段时间内处于发布状态
1. BugN3344：终端按设备授权，没有用户授权，用户无法使用API
1. BugN3357：终端库操作中扫描物料功能异常
1. BugN3382：作业树特殊视图，偶尔会发生后台文件被占用的错误
1. BugN3386：必须完成的作业项数据类型为签名时，可以直接下一步，同步也无异常
1. BugN3389：Web端被嵌入到iframe中发生同源要求而拒绝显示
1. BugN3435：复制已归档的创建计划异常
1. BugN3437：按月重复计划设置为月底时导致有些月份计划不创建
1. BugN3446：库存查询部署到EOC中显示异常
1. BugN3455：删除用户时未删除子孙
1. BugN3477：表格报表下拉按钮中文字没有对齐、没有间隔
1. BugN3478：创建计划弹框中，选过即时创建按钮后，作业组模板列表的滚动条不能拖到最下面
1. BugN3482：库操作通过导入，保存操作项需要验证
1. BugN3483：资产属性的历史趋势列表、可输入列表类型值显示为ID
1. BugN3484：安卓11的小米终端逻辑拍照，不能保存照片
1. BugN3499：EOC中作业树初始隐藏摘要信息，图片将不能放大
1. BugN3501：终端在多层作业后签名数据不能保存
1. BugN3503：通过函数和脚本创建出的作业组，在计划页面不显示作业组属性的值
1. BugN3577：终端扩展页面查询物料，如果数据很多显示比较慢
1. BugN3597：图片太大，导致Word视图显示格式不正确
1. BugN3648：SDC导出自定义列表和列表关联关系后，导入失败
1. BugN3657：SDC导出功能，导出包含的文件数量过多时，再导入会提示文件不存在
1. BugN3665：查询条件窗口中，点击删除，如果有选中的功能按钮，会被删掉
1. BugN3673：报表在宽表模式下，主页中选择其作为数据源显示报错
1. BugN3679：作业项报表和作业项历史报表中点击作业组名称，不会跳转到作业树
1. BugN3688：可选项脚本如果只有Name字段显示不正确
1. BugN3691：数据类型为数组格式的json字符串，其中一个属性不显示属性名，通过脚本更新到作业组属性后，EOC上不显示该属性
1. BugN3692：EOC左侧导航第一个模块点击自由查询有时不好点击
1. BugN3730：数据库为SQLServer时，自定义列表配置列表关联关系后作业组中作业项配置列表约束，发布后删掉了此关联关系
1. BugN3769：作业树中视频放大显示空白，下载能正常显示
1. BugN3813：没勾选按需创建的作业组模板引用了按需创建的作业规范，终端重复创建时失败
1. BugN3815：导航目录图标编辑后不正确
1. BugN3817：画面显示在主页或非编辑画面页面，拖住鼠标，会改变页面显示
1. BugN3831：解决方案模板流程后事件配置不正确
1. BugN3870：即时创建作业组归档后，无法查看作业配置
1. BugN3871：即时创建作业组归档后，复制操作不成功

## 增加的功能详细说明

### PBIN1476：作业组支持表单模式

* 新增表单模式功能，在SDC中的作业组属性栏为作业组模板选择表单模式即可启用。

  <img alt=" " src={useBaseUrl('docimg/sdc4052.png')} />

* 启用之后，在终端执行页面，直接只显示作业组属性，不显示作业项

  <img alt=" " src={useBaseUrl('docimg/biaodan4051.png')} />

* 而终端审核和查看页面不显示摘要信息和作业树

  <img alt=" " src={useBaseUrl('docimg/biaodan4052.png')} />

* 在EOC端作业树页面不显示作业项数和例外作业项数的柱状图、图片和作业树，显示状态为可查看的作业组属性

  <img alt=" " src={useBaseUrl('docimg/biaodan4053.png')} />

### PBIN3222：网页端配置外部链接时可以设置为使用新Tab页打开

* 在自定义导航中，添加直接跳转功能时，新增了是否跳转新窗口按钮，选择是时，则在点击该链接后，浏览器中会使用新Tab页打开，选择否则停留在当前Tab页进行跳转。

  <img alt=" " src={useBaseUrl('docimg/zdydh40451.png')} />

### PBIN3223：使用自己邮件服务器时发件人邮箱和账户可以分开设置

* 在SMC中，使用自己邮件服务器时，可以分开设置发件人邮箱和账户，接收邮件时发送人显示为设置的发送人邮箱，如果发送人邮箱为空，则使用账户作为发送人邮箱。

  <img alt=" " src={useBaseUrl('docimg/smc40451.png')} />

  <img alt=" " src={useBaseUrl('docimg/youjian40451.png')} />

### PBIN3231：移动工作站新界面

* 移动工作站增加新样式，在终端配置-系统中可以选择启用新样式

  <img alt=" " src={useBaseUrl('docimg/zhongduan40451.png')} />

* 退出重新进去，即可看到新界面。登录界面默认简洁样式，点击显示更多就会显示角色、轮班和班次

  <img alt=" " src={useBaseUrl('docimg/zhongduan40452.png')} />

* 登录之后新界面首页有两种排列方式，可以根据自己喜欢选择。除了本身有的功能列表如执行、审核、日志、新建、消息订阅等之外，在EOC端配置的自定义扩展等页面也会显示在首页中。

  <img alt=" " src={useBaseUrl('docimg/zhongduan40453.png')} />

* 执行中包含了待执行、执行中和已执行，审核中包含了待审核和已审核，新建中为可以即时创建的作业组。

* 在“我的”中，可以修改头像、密码和退出登录。

### PBIN3240：作业组特殊视图，如果作业项没有输入值，则根据状态来设定显示值

* 作业组的特殊视图如word，如果作业项没有输入值时，可以根据状态来配置需要显示的值。

* 当指定的标签未完成时，用户替换成指定的字符串：

  * 作业组模板替换中可以增加字符串类型的作业组属性“$ValueOnUnCompleted”，作为指定要替换的字符串。

  * 项目模板替换中可以增加字符串类型的项目属性“$ValueOnUnCompleted”，作为指定要替换的字符串。

  * 如果不指定该属性“$ValueOnUnCompleted”的值，则标签未完成时，替换成空字符串【""】。

* 当指定的作业项标签未完成时，用户替换指定的字符串

  * 当未完成作业项的路径（所在作业）中缺省状态不是【要求作业】的最顶层的作业为【不要求作业】，使用属性名为"$ValueOnUnRequired"的值替换。

  * 当未完成作业项的路径（所在作业）中缺省状态不是【要求作业】的最顶层的作业为【禁止作业】，使用属性名为"$ValueOnForbidden"的值替换。

  * 当作业组属性中不存在属性名为"$ValueOnUnRequired","$ValueOnForbidden"时，都用“$ValueOnUnCompleted”的值替换。

### PBIN3246：项目属性支持根据流程的活动来控制权限

* SDC项目模板中的项目属性，可以像作业组属性一样根据所属流程的活动来控制权限。

  <img alt=" " src={useBaseUrl('docimg/xiangmu40451.png')} />

* 配置完后，当项目流程流转到相应的活动时，使用业务流程里配置的角色登录后，其所见的项目属性就会按照配置的权限展现。

  <img alt=" " src={useBaseUrl('docimg/xiangmu40452.png')} />

### PBIN3308：增加同步后语音提示

* 新增了同步后的语音提示，当终端上同步完成之后，才会通过语音提示。同终端信息语音提示功能一样，在SDC附件中新建附件名为终端同步后信息语音提示，然后上传对应的mp3语音即可。

  <img alt=" " src={useBaseUrl('docimg/tongbuhoutishi4101.png')} />

### PBIN3335：资产属性直接支持连接OPC-DA/UA-Server、MQTT

* 资产的外部属性功能增强，支持直接连接OPC-DA/UA-Server、MQTT

  <img alt=" " src={useBaseUrl('docimg/opc4101.png')} />

* 首先，在SDC资产类别中，新建菜单增加了新建数据源选项，点击可以选择新建OPC-DA/UA-Server、MQTT数据源

  <img alt=" " src={useBaseUrl('docimg/opc4102.png')} />

* 

### PBIN3387：增加修改作业组的名称与描述流程后函数，同时增加插入流程后函数向导

* 新增加了修改作业组的名称与描述的流程后函数UpdateTaskGroupNameDesc，详细请查看[流程自定义函数](/内置函数/流程自定义函数.md)

* SDC中增加了插入流程后函数的向导，在流程活动属性中点击插入函数，可以选择要用到的流程函数，支持直接搜索，并且也对函数进行了分类，点击函数会有简单的说明。关联了在线文档，查看详细说明点击在线帮助即可。

  <img alt=" " src={useBaseUrl('docimg/lchhs40451.png')} />

### PBIN3394：流程后函数支持运行脚本

* 新增加了流程后函数运行脚本的功能，首先，增加了运行脚本的函数ExecuteProcessScript，关于该函数的详细描述请查看[流程自定义函数](/内置函数/流程自定义函数.md)

  <img alt=" " src={useBaseUrl('docimg/lchhs40452.png')} />

* 然后,在SDC作业组属性更多设置中，新增了流程后脚本，同时提供了几个脚本例子。

  <img alt=" " src={useBaseUrl('docimg/lchhs40453.png')} />

* 当流程中该活动结束后，函数中配置的属性中如果存在流程后脚本，就会运行。

### PBIN3398：终端主页支持自定义

* 终端的新样式主页支持通过配置来自定义显示。根据配置，可以把执行、新建、审核都可以分成不同的模块，同时可以决定其中显示哪些作业组，这样就形成了一个新的主页。

* 首先，要在EOC系统扩展管理中新增终端自定义页面，然后在其他配置中填写如下内容：

```
{
  "name": "newMain",
  "beforeShow": "",
  "beforeHide": "",
  "getContent": "function(_context,_cfg){var list =[{'Name':'测试1-执行','IsAliIcon':true,'IconClass':'aliicon-ali-baseinfo','JumpToPageType':'executeOverview','FilterCondition':{'TaskGroupTemplateNames':'车间巡检','GroupNames':'巡检组'}},{'Name':'测试2-审核','IsAliIcon':true,'IconClass':'aliicon-ali-audit','JumpToPageType':'auditOverview',},{'Name':'测试3-新建','IsAliIcon':false,'IconClass':'idong-icon icon-toExecuteTG-idong','JumpToPageType':'createOverview','FilterCondition':{'TaskGroupTemplateNames':'备件入库,车间巡检-副本-副本','GroupNames':'库操作组,巡检组'}},{'IsDynamic':true,'Name':'物料打印','IsAliIcon':false,'IconClass':'idong-icon icon-toExecuteTG-idong'}];return list;}"
}
```

  <img alt=" " src={useBaseUrl('docimg/zdzdyzy4051.png')} />

* 格式前后固定，只需要修改两个list中的各项名称就行。根据本地解决方案中的作业组模板名和分组名修改其中的值，其中：
  * Name:显示的名称，必填
  * IsAliIcon:是否是阿里图标，true或false，选填
  * IconClass:图标的名称，字符串，选填，如果是阿里图标aliicon-ali-baseinfo，如果不是阿里图标idong-icon icon-toExecuteTG-idong
  * JumpToPageType:跳转的页面，必填，新建-createOverview,执行-executeOverview,审核-auditOverview
  * FilterCondition:跳转页面的筛选数据条件，选填，筛选出的数据会既满足TaskGroupTemplateNames又满足GroupNames
  * TaskGroupTemplateNames:作业组模板名称，选填
  * GroupNames:作业组组名，选填

* 图中配置在终端上的效果为，执行模块更名为测试1-执行，其中可显示的作业组模板名称为车间巡检，分组为巡检组。审核模块更名为测试2-审核，未做筛选。新建模块更名为测试3-新建，可显示的作业组模板名为备件入库和车间巡检-副本-副本，分组分别为库操作组和巡检组。显示其他终端扩展页面如物料打印。

* 其他模块，日志，消息订阅不含FilterCondition字段，其他字段和新建、执行、审核含义相同，JumpToPageType都是固定
。

```
日志
 {
     'Name': '日志',
     'IconClass': 'idong-icon icon-log-idong fontIcon mui-icon',
     'JumpToPageType': 'operaLog',
    'IsAliIcon': false
 }
 消息订阅
 {
     'Name': '消息订阅',
     'IconClass': 'aliicon-ali-msgSubscription',
     'JumpToPageType': 'msgSubscription',
     'IsAliIcon': true
 }
```

* 新建、执行、审核、日志、消息订阅的JumpToPageType值都是固定的，不能改；而FilterCondition这个字段只有新建、执行、审核有，非必填，可以不写。
* TaskGroupTemplateNames后面是可以写多个，英文逗号分隔，如'车间巡检,车间巡检123'，如果多个的分组不一样，那GroupNames里也写多个分组是可以匹配上的。
* 分组是进一步的筛选作业组，如果只需要作业组模板能符合条件，可以不写分组，格式都是'aaa,bbb'。换言之，想要某个作业组分组的所有模板，那就只用写这个组名来显示下面的模板，只想要某一个或几个模板，那就只用写相应的模板名。作业组模板名和组名都有值的情况下，是筛选既符合作业组模板名的作业组，也符合分组名的作业组。

* 配置系统扩展中的'终端自定义' 都有加一个固定字段IsDynamic(是否动态)值都为true，如图中有名称为物料打印的终端自定义查询，在自定义的新主页中希望可以显示，则只需在其中加上{'IsDynamic':true,'Name':'物料打印','IsAliIcon':false,'IconClass':'idong-icon icon-toExecuteTG-idong'}即可，还有其他的，使用英文逗号隔开，继续加上。

```
 {
     'IsDynamic':true, // 必填，值为true
     'Name':'xxx'  // 必填，系统扩展中系统扩展名，如果重复，只能显示第一个
      'IsAliIcon':xx, // 选填
      'IconClass':'xx' // 选填
 }
```

* 详细配置说明：

```
//注意：此段为配置说明，不是配置。

// 只配置执行、审核、新建模块的完整配置
var list = [{
    'Name': '作业组属性增强-字符串-执行',
    'IsAliIcon': true,
    'IconClass': 'aliicon-ali-baseinfo',
    'JumpToPageType': 'executeOverview',
    'FilterCondition': {
        'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
        'GroupNames': '表单模式'
    }
}, {
    'Name': '作业组属性增强-字符串-审核',
    'IsAliIcon': true,
    'IconClass': 'aliicon-ali-audit',
    'JumpToPageType': 'auditOverview',
}, {
    'Name': '作业组属性增强-字符串-新建',
    'IsAliIcon': false,
    'IconClass': 'idong-icon icon-toExecuteTG-idong',
    'JumpToPageType': 'createOverview',
    'FilterCondition': {
        'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
        'GroupNames': '表单模式'
    }
}];
// 配置执行、审核、新建模块如下配置，
// Name:显示的名称，必填
// IsAliIcon:是否是阿里图标，true或false，选填
// IconClass:图标的名称，字符串，选填，如果是阿里图标aliicon-ali-baseinfo，如果不是阿里图标idong-icon icon-toExecuteTG-idong
// JumpToPageType:跳转的页面，必填，新建-createOverview,执行-executeOverview,审核-auditOverview
// FilterCondition:跳转页面的筛选数据条件，选填，筛选出的数据会既满足TaskGroupTemplateNames又满足GroupNames
//     TaskGroupTemplateNames:作业组模板名称，选填
//     GroupNames:作业组组名，选填
// 执行{
//     'Name': '作业组属性增强-字符串-执行',
//     'IsAliIcon': true,
//     'IconClass': 'aliicon-ali-baseinfo',
//     'JumpToPageType': 'executeOverview',
//     'FilterCondition': {
//         'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
//         'GroupNames': '表单模式'
//     }
// };
// 新建{
//     'Name': '作业组属性增强-字符串-新建',
//     'IsAliIcon': false,
//     'IconClass': 'idong-icon icon-toExecuteTG-idong',
//     'JumpToPageType': 'createOverview',
//     'FilterCondition': {
//         'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
//         'GroupNames': '表单模式'
//     }
// },
// 审核 {
//     'Name': '作业组属性增强-字符串-审核',
//     'IsAliIcon': true,
//     'IconClass': 'aliicon-ali-audit',
//     'JumpToPageType': 'auditOverview',
// });


// 其他模块，日志，消息订阅不含FilterCondition字段，其他字段和新建、执行、审核含义相同，JumpToPageType都是固定
// 日志
// {
//     'Name': '日志',
//     'IconClass': 'idong-icon icon-log-idong fontIcon mui-icon',
//     'JumpToPageType': 'operaLog',
//     'IsAliIcon': false
// }
// 消息订阅
// {
//     'Name': '消息订阅',
//     'IconClass': 'aliicon-ali-msgSubscription',
//     'JumpToPageType': 'msgSubscription',
//     'IsAliIcon': true
// }


// 配置系统扩展中的'终端自定义' 都有加一个固定字段IsDynamic(是否动态)值都为true
// {
//     'IsDynamic':true, // 必填，值为true
//     'Name':'xxx'  // 必填，系统扩展中系统扩展名，如果重复，只能显示第一个
//      'IsAliIcon':xx, // 选填
//      'IconClass':'xx' // 选填
// }


// var list = [{
//     'Name': '作业组属性增强-字符串-执行',
//     'IsAliIcon': true,
//     'IconClass': 'aliicon-ali-baseinfo',
//     'JumpToPageType': 'executeOverview',
//     'FilterCondition': {
//         'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
//         'GroupNames': '表单模式'
//     }
// }, {
//     'Name': '作业组属性增强-字符串-审核',
//     'IsAliIcon': true,
//     'IconClass': 'aliicon-ali-audit',
//     'JumpToPageType': 'auditOverview',
// }, {
//     'Name': '作业组属性增强-字符串-新建',
//     'IsAliIcon': false,
//     'IconClass': 'idong-icon icon-toExecuteTG-idong',
//     'JumpToPageType': 'createOverview',
//     'FilterCondition': {
//         'TaskGroupTemplateNames': '表单模式-作业组属性增强-字符串',
//         'GroupNames': '表单模式'
//     }
// },
// {
//     'IsDynamic': true,
//     'Name': '资产属性',
//     'IsAliIcon': false,
//     'IconClass': 'idong-icon icon-toExecuteTG-idong'
// },
// {
//     'IsDynamic': true,
//     'Name': '模糊查询 - 云',
// },
// {
//     'IsDynamic': true,
//     'Name': '新访问EOC-报表',
// }];

```

* 在EOC中计划了两个作业组：

  <img alt=" " src={useBaseUrl('docimg/zdzdyzy4052.png')} />  

* 终端上配置自定义主页后的效果 ：

  <img alt=" " src={useBaseUrl('docimg/zdzdyzy4053.png')} />


  <img alt=" " src={useBaseUrl('docimg/zdzdyzy4054.png')} />

  <img alt=" " src={useBaseUrl('docimg/zdzdyzy4055.png')} />

### PBIN3454：计划显示作业组完成状态和是否归档

* EOC端计划页面，增加了作业组完成状态显示，归档之后显示已归档。

  <img alt=" " src={useBaseUrl('docimg/jihua40451.png')} />

### PBIN3463：人员、资产和组织单元资质管理，同时支持附件

* 新增资质管理功能，在EOC上报表中新增了资质及对象资质，SDC端作业组右侧属性栏中新增所需资质，以及不满足资质要求。

  <img alt=" " src={useBaseUrl('docimg/zizhi40451.png')} />

* 首先，需要在资质页面新建资质，建立完毕后在用户资质页面，选择人员、资产或组织单元来配置所拥有的资质，并且支持添加附件。

  <img alt=" " src={useBaseUrl('docimg/zizhi40452.png')} />

* 同时，在消息类型管理中，也增加了资质过期的消息提醒，默认到期前30天、7天和当天会发送消息。这里为统一管理，如果某项资质需要单独的消息提醒，在新建资质时，有一列为通知周期，设定好值，则该资质会按照通知周期来发送提醒。

  <img alt=" " src={useBaseUrl('docimg/zizhiguoqi4101.png')} />

* 之后，在作业组属性栏中，选择执行该作业组时所需的资质，再选择不满足资质要求即可。

  <img alt=" " src={useBaseUrl('docimg/zizhi40453.png')} />

* 然后在终端上，只有满足资质要求的用户可以接收并执行该作业组模板产生的计划。不满足资质的用户则遵循不满足资质要求的选择。如果资质存在隐含关系，则本身资质隐含了满足资质要求的用户也可执行。

  <img alt=" " src={useBaseUrl('docimg/zizhi40454.png')} />

* 目前只有用户资质与作业组所需资质有联系，资产和组织单元的资质只是提醒和管理作用。

### PBIN3492：作业组模板可以设置计划提前创建的时间

* 在SDC中，作业组属性栏新增计划提前创建的小时数。设置后的作业组模板在计划后提前创建出来的时间遵循此设置，没有设置的作业组模板遵循SDC设置中的。

  <img alt=" " src={useBaseUrl('docimg/jihuachuangjian40451.png')} />

### PBIN3506：终端支持蓝牙电子秤

* 终端新增支持蓝牙电子秤，首先在SDC中作业项属性栏、作业组属性更多设置以及作业组属性json字符串中的更多设置的数据输入方式都新增了电子秤，相应的字段名新增了重量。

  <img alt=" " src={useBaseUrl('docimg/lanyadianzicheng40451.png')} />

* 配置完成后，手机需打开蓝牙，在终端执行到该作业项时，会自动搜索蓝牙，选择电子秤后，即可读取电子秤数据为数据值。
  
  <img alt=" " src={useBaseUrl('docimg/lanyadianzicheng40452.png')} />

* 目前已支持的电子秤品牌型号为匠牛的匠准天平。

### PBIN3507：终端支持打印

* 移动工作站新增支持打印功能，此功能需要使用带打印机的终端。

* 使用打印功能可以在执行作业项时单独打印，也可以在iis中添加一个应用程序，再在EOC端新增一个终端自定义查询，然后在终端进入此页面选择进行打印。

* 单独打印在作业项添加脚本中，写如下脚本：

```
var printObj = {
     Title:'上海艾动信息科技有限公司',
     Footer:'北京开发部',
     Properties:{
      '房间':'410-2',
      '类型':'开放空间',
      '大小':'20 m',
      '时间':'2022-05-18 17:12',
     },
     QRCodeText:'0123456789012345'
    }
    Scan.StartPrint(JSON.stringify(printObj)); 
   return true;
```

* 执行该作业项，即可跳转到打印界面，进行打印。

  <img alt=" " src={useBaseUrl('docimg/dayin40451.png')} />

* 终端页面选择打印需要首先在iis的EOC目录中添加应用程序，点此下载：<a href={useBaseUrl('docattachment/dayin.zip')} target="_blank">打印应用程序</a>，下载后解压，再如图添加即可

  <img alt=" " src={useBaseUrl('docimg/dayin40452.png')} />

* 之后在EOC系统扩展管理页面，添加终端自定义查询，将下面代码写进其他配置中，注意：url中的ip为终端同步的ip，ip后的名称wuliaodayin为在iis中添加应用程序时所取的名。

```
{
    "Url":"http://192.168.31.33:80/wuliaodayin/#/QueryMaterial?time=0320",
    "WithUserInfo":true,
    "Extras":{
    "materialListConfig": {
      "Columns": [
        {
            "Field": "ID",
            "Title": "物料ID",
            "IsHide": true
        },
        {
            "Field": "No",
            "Title": "物料号",
            "IsHide": false
        },
        {
            "Field": "Name",
            "Title": "物料名",
            "IsHide": false
        },
        {
            "Field": "Unit",
            "Title": "单位",
            "IsHide": false
        },
        {
            "Field": "Category",
            "Title": "类别",
            "IsHide": false
        }
      ],
      "PrintQRCodeHeaderText": "上海艾动信息科技有限公司",
      "PrintQRCodeFooterText": "北京开发部"
    },
    "materialDetailConfig": {
      "Columns": [
        {
          "Field": "ID",
          "Title": "物料ID",
          "IsHide": true
        },
        {
          "Field": "No",
          "Title": "物料号",
          "IsHide": false
        },
        {
          "Field": "Name",
          "Title": "物料名",
          "IsHide": false
        },
        {
          "Field": "Unit",
          "Title": "单位",
          "IsHide": false
        },
        {
          "Field": "Category",
          "Title": "类别",
          "IsHide": false
        },
        {
          "Field": "StandardTime",
          "Title": "标准工时",
          "IsHide": false
        },
        {
          "Field": "StandardPrice",
          "Title": "标准价格",
          "IsHide": false
        },
        {
          "Field": "SalePrice",
          "Title": "销售价格",
          "IsHide": false
        },
  {
          "Field": "QualifiedSupplierIDs",
          "Title": "合格供应商IDs",
          "IsHide": true
        },
        {
          "Field": "QualifiedSupplierNames",
          "Title": "合格供应商",
          "IsHide": false
        }
      ],
      "PrintQRCodeHeaderText": "上海艾动信息科技有限公司",
      "PrintQRCodeFooterText": "北京开发部"
    }
  }
}
```

  <img alt=" " src={useBaseUrl('docimg/dayin40453.png')} />

* 添加完成后，终端同步显示此页面，进入选择物料打印即可

  <img alt=" " src={useBaseUrl('docimg/dayin40454.png')} />

  <img alt=" " src={useBaseUrl('docimg/dayin40455.png')} />

  <img alt=" " src={useBaseUrl('docimg/dayin40456.png')} />

### PBIN3508：终端物料查询扩展页面

* 终端上扩展页面支持物料查询，包含物料打印功能，详见PBIN3507中关于iis添加应用程序及EOC添加终端自定义查询的部分。

### PBIN3509：终端库存操作支持选择同时选择多个物料

* 终端进行库存操作时，选择物料可以多选，多选之后一同添加进库操作界面

  <img alt=" " src={useBaseUrl('docimg/wuliao40451.png')} />

  <img alt=" " src={useBaseUrl('docimg/wuliao40452.png')} />

### PBIN3510：优化终端作业组执行页面
* 用户进入主页，选择执行界面,选择一个作业组，单击展开

 <img alt=" " src={useBaseUrl('docimg/执行1.jpg')} />

* 作业组的属性显示

 <img alt=" " src={useBaseUrl('docimg/执行2.jpg')} />

### PBIN3511：终端审核类消息跳转支持跳转到审核或详细

* 通过终端点击消息

 <img alt=" " src={useBaseUrl('docimg/消息审核1.png')} />

 * 进入消息中心，点击审核

 <img alt=" " src={useBaseUrl('docimg/消息审核2.png')} />

 * 可以跳转到审核界面

  <img alt=" " src={useBaseUrl('docimg/消息审核3.jpg')} />

 * 可以输入审核意见，作业组批准，退货，后退，终止都可以

 <img alt=" " src={useBaseUrl('docimg/消息审核4.png')} />

### PBIN3515：终端库操作物料模糊搜索不区分大小写

* 终端库操作时，对于物理的搜索功能优化，不再区分大小写，字符匹配即可搜索到。

  <img alt=" " src={useBaseUrl('docimg/zhongduanwuliao4101.png')} />

### PBIN3516：终端支持自动登录

* 终端新增自动登录功能，在登录页面，勾选自动登录，在新样式中退出移动工作站不会退出应用，下次打开移动工作站后将自动登录，同时强制关闭移动工作站后，再打开依然可以自动登录。有项目存在的情况下，打开后首先跳出项目选择，选择后即可登陆。

  <img alt=" " src={useBaseUrl('docimg/zddenglu40451.png')} />

### PBIN3517：作业组模板增加预设时长，计划时缺省使用此时长

* 在SDC中，作业组属性栏新增计划缺省时长分钟数。设置后的作业组模板在计划时，缺省的时长间隔遵循此设置。

  <img alt=" " src={useBaseUrl('docimg/jihuashichang40451.png')} />

  <img alt=" " src={useBaseUrl('docimg/jihuashichang40452.png')} />

### PBIN3580：审核支持作业组模板名称为查询条件

* EOC审核页面，查询条件新增作业组模板名称，可通过设置此条件查找对应需要审核的作业组。

  <img alt=" " src={useBaseUrl('docimg/shenhe40451.png')} />

### PBIN3581：作业组维护页面作业组名称修改为模糊搜索

* EOC作业组维护页面，查询作业组名称由全名称搜索修改为模糊搜索，提高搜索效率。

  <img alt=" " src={useBaseUrl('docimg/zuoyezuweihu40451.png')} />

### PBIN3595：内置作业组属性扩展KPI的配置和管理

* 优化了对于内部KPI扩展的配置和管理，支持根据作业组属性统计分析。具体说明如下：

* 配置

  * “config.json”配置样例：

```json
{
  "DimensionList": [
    {
      "DimensionName": "时间"
    },
    {
      "DimensionName": "组织单元"
    },
    {
      "DimensionName": "人员"
    },
    {
      "DimensionName": "例外等级"
    },
    {
      "DimensionName": "作业组"
    },
    {
      "DimensionName": "班次"
    },
    {
      "DimensionName": "业务范畴"
    }
  ],
  "ChildKPIList": [
    {
      "ChildKPIID": "Number",
      "ChildKPIName": "数量",
	  "CalculateType":0,
	  "Unit":"个",
	  "Numerator":{
	  "ColName":"Number"
	  }
    },
    {
      "ChildKPIID": "Good",
      "ChildKPIName": "好评",
	  "CalculateType":0,
	  "Unit":"条",
	  "Numerator":{
	  "ColName":"Good",
	  "Type":1,
	  "IsCondition":true,
	  "Operator":"=",
	  "Condition":"09A5FA8B-52EE-4C6E-B3CC-29135D38DC8C"
	  }
    },
	{
      "ChildKPIID": "Bad",
      "ChildKPIName": "非好评",
	  "CalculateType":0,
	  "Unit":"条",
	  "Numerator":{
	  "ColName":"Good",
	  "Type":1,
	  "IsCondition":true,
	  "Operator":"<>",
	  "Condition":"09A5FA8B-52EE-4C6E-B3CC-29135D38DC8C"
	  }
    },
	 {
      "ChildKPIID": "GoodRate",
      "ChildKPIName": "好评率",
	  "CalculateType":1,
	  "Unit":"%",
	  "Numerator":{
		  "ColName":"Good",
		  "Type":1,
		  "IsCondition":true,
		  "Operator":"=",
		  "Condition":"09A5FA8B-52EE-4C6E-B3CC-29135D38DC8C"
	  },
	  "Denominator":{
		"ColName":"Good",
		"Type":1
	  }
    },
	 {
      "ChildKPIID": "BadRate",
      "ChildKPIName": "非好评率",
	  "CalculateType":1,
	  "Unit":"%",
	  "Numerator":{
		  "ColName":"Good",
		  "Type":1,
		  "IsCondition":true,
		  "Operator":"<>",
		  "Condition":"09A5FA8B-52EE-4C6E-B3CC-29135D38DC8C"
	  },
	  "Denominator":{
		"ColName":"Good",
		"Type":1
	  }
    }
  ],
  "EtlDatas": [
  
    {
      "Type": 1,
      "ID": "",
      "Name": "数量",
      "ColName": "Number",
      "DataType": 3
    },
    {
      "Type": 1,
      "ID": "",
      "Name": "好评",
      "ColName": "Good",
      "DataType": 1
    }
  ],
  "TableName": "TestNew_new",
  "TableVersion": 1,
  "CustomType": 1,
  "ExtractTime": 1,
  "NeedExtractTaskGroupIDs": "7902b8d2-3f61-4fdf-bea1-6b23bc65933e"
}
```

* 配置说明

```
  DimensionList 维度 数组
    自定义kpi的维度，当前支持 ‘时间’，‘组织单元’，‘人员’，‘例外等级’，‘作业组’，‘班次’，‘业务范畴’；
    DimensionName 值必须为当前支持的维度名称

  ChildKPIList 子KPI 数组
  ChildKPIID    子KPIID 在同一个配置中为唯一字符串（英文字符串）
  ChildKPIName  子KPI名称
  CalculateType 子KPI的计算方式，枚举类型；1求和，1求百分率（结果会*100），2求比
  Unit  单位
  Numerator 分子；如果求和类型则为值，如果为百分率或求比则为分子
    ColName 当前元素在数据库中字段名
    Type 统计方式 枚举类型 0求和，1计数
    IsCondition 是否为条件 bool类型 true则会使用条件查询，false则统计所有
    Operator 条件符号 字符串 支持 =,<>,>,>=,<,<=
    Condition 当前元素的条件 字符串
  Denominator 分母；求和类型为空，求百分率或求比为分母 内部元素与Numerator相同
  
  EtlDatas 抽取数据 数组
    Type 数据抽取的来源类型 枚举类型 0作业项值或作业状态，1作业组属性
    Name 数据来源名称或者ID 字符串 作业组属性只支持名称，作业项或者作业状态支持ID或者名称（同一个作业组中相同的则随机取值，尽量避免抽取数据在作业组重名或引用相同的作业规范）
    ColName 抽取的数据在数据库中的字段名称
    DataType 抽取的数据在数据库中的类型 枚举类型 0:未知,Guid=1,String=2,Int=3,TinyInt=31,SmallInt=32,BigInt=33,Double=35,DateTime=4,Bool（bit）=5

其他配置
  TableName 数据库表名称 字符串
  TableVersion 表版本号 正整数 注：当同一个数据表的版本号不同时，会重新创建表不兼容旧数据
  CustomType 自定义KPI的类型 枚举类型 0独立部署 缺省值 ，1内部扩展kpi
  ExtractTime 抽取时间 枚举类型 0 不抽取，1作业组归档后
  NeedExtractTaskGroupIDs 需要抽取的作业组模板ID列表 字符串 多个则使用','分割
```

* 在系统扩展管理中添加自定义KPI

  <img alt=" " src={useBaseUrl('docimg/kpi4101.png')} />

* 显示效果

  <img alt=" " src={useBaseUrl('docimg/kpi4102.png')} />

### PBIN3599：修改资产属性具有权限控制

* EOC权限控制功能增加，新增了修改资产属性权限功能，添加管理员，则只有该管理员可以在资产总览和资产属性报表中对资产属性进行修改。

  <img alt=" " src={useBaseUrl('docimg/quanxian4051.png')} />

* 非管理用户登录则只可以查看。

  <img alt=" " src={useBaseUrl('docimg/quanxian4052.png')} />

### PBIN3602：重构网页端图标选择对话框，同时增加更多的图标

* 重构了EOC上选择图标的对话框，对图标进行了详细的分类，更改了排列方式，并增加阿里图标。

  <img alt=" " src={useBaseUrl('docimg/eoctubiao4051.png')} />

### PBIN3606：支持智能摄像头，实现无感考勤，实时感知人员状态

* 增加了扩展功能，支持智能摄像头，用以实现无感考勤，通过摄像头识别人员上下班时间感知人员的状态，辅以预设好的算法来得出人员的考勤状况。

  <img alt=" " src={useBaseUrl('docimg/wugankaoqin4101.png')} />

* 目前支持的智能摄像头为百度的度目室内摄像头，配置流程请参考：<a href={useBaseUrl('docattachment/无感考勤摄像头配置流程.docx')} target="_blank">无感考勤摄像头配置流程</a>，文中提到的搜索工具：<a href={useBaseUrl('docattachment/度目智能摄像机升级工具&搜索工具.rar')} target="_blank">智能摄像机升级工具&搜索工具</a>

* 之后使用超级管理员登陆EOC-配置-人脸库，在其中将需要参与考勤的人员进行注册，建议使用脸部清晰的正面照

  <img alt=" " src={useBaseUrl('docimg/wugankaoqin4103.png')} />

* 在系统扩展管理-自定义报表-项目扩展和实例中，选择无感考勤，添加此报表

  <img alt=" " src={useBaseUrl('docimg/wugankaoqin4104.png')} />

* 最后，通过考勤Service程序，就可以将EOC中注册的信息推送至摄像头后台，再将摄像头后台中的识别记录抽取到系统中，通过设置好的算法，判断人员考勤状态，将信息展示在报表中了。

  <img alt=" " src={useBaseUrl('docimg/wugankaoqin4105.png')} />

### PBIN3643：SDC增加新建智能设备和数据源菜单

* 在SDC列表管理器→资产类别的新建菜单中，增加了新建智能设备和新建数据源。新建智能设备中包括了目前系统已经完成开发集成的智能设备，直接点击即可新建出来。

  <img alt=" " src={useBaseUrl('docimg/sdc4101.png')} />

* 新建数据源则是在使用外部数据源时需要新建出来，目前支持OPCUA，OPCDA和MQTT。

  <img alt=" " src={useBaseUrl('docimg/sdc4102.png')} />

### PBIN3659：优化物料选择窗口

* 物料选择窗口优化，库操作的弹框中选择物料，当物料数据多的时候显示会较慢，现在是开始只显示200条，滚动条滑到弹框底部再加载200条，每次200条，显示速度变快。如果有存储区域，先显示库存表相关的物料，点击显示全部，才显示所有物料。

  <img alt=" " src={useBaseUrl('docimg/kucaozuo4051.png')} />

### PBIN3660：库操作和导入支持多存储区域

* 库存表中库操作功能增强，现在支持多存储区域一起操作，库操作中的导入也支持多存储区域。

  <img alt=" " src={useBaseUrl('docimg/kucun4050.png')} />

* 点击新增，则是单个存储区域多个物料的库操作，点击新增一组，就可以新增加一组包括选择存储区域的库操作。

  <img alt=" " src={useBaseUrl('docimg/kucaozuo4051.png')} />

* 项信息默认隐藏，可以点击显示项信息然后进行配置。全部库操作配置完后点击确定，即可完成多个区域的库操作，在库存条目表中，也会相应的添加库操作数据。

  <img alt=" " src={useBaseUrl('docimg/kucaozuo4052.png')} />

* 导入数据的方式则是下载模板后，在模板文件中的目标存储区域列可以是多个区域，在excel中把数据配置好后选择导入数据点确定即可。

  <img alt=" " src={useBaseUrl('docimg/kucaozuo4053.png')} />

* 作业组属性库操作不支持多存储区域。

### PBIN3680：以值为筛选条件的报表查询优化

* 优化了能够以值为筛选条件的报表的查询，优化前如下：

  <img alt=" " src={useBaseUrl('docimg/bbcx4101.png')} />

* 优化后：

  <img alt=" " src={useBaseUrl('docimg/bbcx4102.png')} />

### PBIN3683：作业组属性报表支持特殊视图的批量导出

* 作业组属性报表中增加配置支持，可以将该作业组属性中的特殊视图单独导出或批量导出，在自定义xml文件中的配置如下

  <img alt=" " src={useBaseUrl('docimg/zyzsxbb4101.png')} />

```
	<CustomReportColumn>
      <Field>Name1</Field>
      <Title>$DisplayTemplate</Title>
      <Width>150</Width>
      <Type>String</Type>
      <FormatType>SpecialView</FormatType>
      <Visiable>true</Visiable>
	</CustomReportColumn>
```

```
<Toolbar>["Save","SaveAs","Export","Query","Refresh","NoFilter","SpecialViewBatchExport"]</Toolbar>
```

* 其中SpecialView为特殊视图赋予了单独点击单独下载的功能，而SpecialViewBatchExport会在功能栏增加一个批量下载按钮，可以将当前页面的特殊视图批量导出，并带有导出进度条，导出的文件名称为作业组名称+视图模板名称+创建时间。NoFilter为不要筛选按钮，如果需要可以去掉。

  * 单独下载

    <img alt=" " src={useBaseUrl('docimg/zyzsxbb4102.png')} />

  * 批量下载

    <img alt=" " src={useBaseUrl('docimg/zyzsxbb4103.png')} />

### PBIN3697：增强系统安全性

* 增强了系统的安全性，在SDC和SMC中增加了相关的配置。其中，SDC的设置里，安全策略中，新增了连续密码输入错误次数和账户锁定时长。如果在用户登录时，密码连续输入错误的次数大于等于设定值时，账户将被锁定，解锁之前无法登陆，如果设定值为0则不受控制。网页端和终端通用此功能，如在EOC上被锁定，则终端也会锁定

  <img alt=" " src={useBaseUrl('docimg/anquan4051.png')} />

  <img alt=" " src={useBaseUrl('docimg/anquan4052.png')} />

* 在SMC系统设置-系统参数中，增加了安全部分，其中包括启用登录验证码，开启后EOC登录时除了需要输入密码外，还需要输入随机生成的验证码；启用XSS防护和外部域名白名单（多个域名间用逗号或回车分隔，如果为空则不进行安全控制），修复网页端URL跳转漏洞。

  <img alt=" " src={useBaseUrl('docimg/anquan4053.png')} />

  <img alt=" " src={useBaseUrl('docimg/anquan4054.png')} />

* 网页端上载文件扩展名限制用于限制EOC中上传文件的格式，只可以上传框中填写了的扩展名，如不填则不限制

  <img alt=" " src={useBaseUrl('docimg/anquan4055.png')} />

* 同时,对于IIS短目录名枚举漏洞，可以自行修复，办法如下：
  * 关闭NTFS 8.3文件格式的支持。该功能默认是开启的，对于大多数用户来说无需开启。修改注册表项：（重启服务器生效）HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation值为1

  <img alt=" " src={useBaseUrl('docimg/anquan4056.png')} />

  * 执行DOS命令：```fsutil behavior set disable8dot3 1```

  <img alt=" " src={useBaseUrl('docimg/anquan4057.png')} />

  * IIS请求筛选中，增加禁止url中使用“~”或它的Unicode编码

    <img alt=" " src={useBaseUrl('docimg/anquan4059.png')} />

    <img alt=" " src={useBaseUrl('docimg/anquan40591.png')} />

### PBIN3716：终端和Web进入JSON新建或编辑窗口时光标自动选中第一项

* 在终端或Web端，当新建或编辑打开json类型的窗口时，光标会自动选中第一项

  <img alt=" " src={useBaseUrl('docimg/json4101.png')} />

  <img alt=" " src={useBaseUrl('docimg/json4102.png')} />

### PBIN3719：资产和人员的导入工具集成到SDC中

* SDC选择解决方案，从Excel导入

<img alt=" " src={useBaseUrl('docimg/导入1.jpg')} />

* 可以在工具里面下载模板

<img alt=" " src={useBaseUrl('docimg/导入2.png')} />

* 把数据补充到Excel里面，开始导入

<img alt=" " src={useBaseUrl('docimg/导入3.jpg')} />

### PBIN3720：终端自定义页面支持显示后脚本

* EOC系统扩展管理中的自定义页面，支持显示后脚本。举例如有紧急的工单，希望能在工单前增加一个明显的标识图标，在终端同步下此工单后，可以看到图标，从而得知是紧急的情况，优先处理。

* 首先，在系统扩展管理中分别添加三个自定义页面，依次为:

1、主页

  含有 “是否紧急” 作业组属性，且属性值为“9fe21234-78df-4521-8744-802d50e40bd1”的作业组
  
  作业组名称前面显示一个指定的图片
  
  注：属性值如果是列表，则需要使用列表项ID；要插入的图标必须转化为base64

```
{
  "name": "main",
  "beforeShow": "function(_context, _cfg) {}",
  "afterShow": "function(_context, _cfg) {
var daAccess = new DAAccess();
    var daProperty = daAccess.GetDA(SyncEntity.TaskGroupProperty);
    daProperty.GetTaskGroupIDsByPropertyValue('是否紧急', '9fe21234-78df-4521-8744-802d50e40bd1', function (success, ids) {
        if (success && ids && ids.length > 0) {
            var tgs = $('.mainTaskGroup');
            var imagebase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAk9JREFUOE+Fk01oFlcUhp93kpkIBVcqXZgJoZZ80YWm6aILIdFN/QGhtLpIiy4s4k6brrqpSpONYnFRaAOCQsFFpS5qK7Yu4g/aEgRDoXwTgxK/hBZcFbGFTDL3bWf65cdq07u6vOech3vee454wZnsiHsKeE3WVqzC8nVF3O2ayrN/p2u5UO9IBmQGgd4XgYHLcdCHr8zMTi7EFwH1NPlWsPs/Cp+RDSe6G/nxUqwA9fa2NyVfBZ4APxp+isAB9sl+vFgt9S/eA5trM/nPmtzA6pAndwybDH+Cj0a4HqxPpKgVUcge7WrkJ7I02Qt8VUHs6y95bpfqaXxIaMTwWwS3CD5NpJ3L31wWT77M2vk4GZF4ayFm8a6yNPkSeO//encI/d0z8zeyNLkHbKnyxXAJmAI6lvr0+7LWVmEjR5VPwmG01pi/nbXHozS9MHxdAqaB9U1Hj1vRTfA72Hua+kOLsdYifFG0tEaE4uMFgMylElCaUppTnofgb0BzFmsie7eIhgIeNj4v6VXMjmXtntREe9sHlj9tivta4JcCf1ZrzG3POpIhmT8C/kHobkuSrAt5/r2h5x8PfFATnfFmFxqvfgY+AlbJ7qtNz22bSJNjoTJYgypfZu4T+STWWeB3An3VIGXt8WGkz20GJC6UiYW9vyVSKtgYoFNwALho+4qkcxZvdz/KLy2OcpYmXuErywld3YxPIcZrj/JqHp5ZpiyNz4COrAD6FXSq1pg989wyLQj1NO6NFL2B/bqhX1AYXcNhrDVp+27Dg6dLu/F30V+TSu1LwjhwUwAAAABJRU5ErkJggg==';
            _.each(tgs, function (_tgDom) {
                var tg = $(_tgDom).data('taskgroup');
                if (tg) {
                    var tgTitle = $('.taskGroupTitle', _tgDom);
                    $('.user_emergency', tgTitle).remove();
                    var find = _.find(ids, function (_id) { return _id == tg.ID; });
                    if (find) {
                        tgTitle.prepend('<img class=\"user_emergency\" style=\"\" src=\"' + imagebase64 + '\"/>');
                    }
                }
            });
        }
        else {
            $('.user_emergency').remove();
        }
    });
   }",
  "beforeHide": "function(_context, _cfg) { }"
}
```

2、执行页

如果作业组含有 “是否紧急” 属性，且属性值为“9fe21234-78df-4521-8744-802d50e40bd1”

作业组名称前面显示一个指定的图片

注：属性值如果是列表，则需要使用列表项ID；要插入的图标必须转化为base64

```
{
  "name": "execute",
  "beforeShow": "function(_context, _cfg) {}",
  "afterShow": "function(_context, _cfg) {
var value = page.executeTaskCommon.GetTaskGroupPropertyValue('是否紧急');
    var tgTitle = $('.taskGroupName', '.taskGroupNameContainer');
    $('.user_emergency').remove();
    if (value && value == '9fe21234-78df-4521-8744-802d50e40bd1') {
        var imagebase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAk9JREFUOE+Fk01oFlcUhp93kpkIBVcqXZgJoZZ80YWm6aILIdFN/QGhtLpIiy4s4k6brrqpSpONYnFRaAOCQsFFpS5qK7Yu4g/aEgRDoXwTgxK/hBZcFbGFTDL3bWf65cdq07u6vOech3vee454wZnsiHsKeE3WVqzC8nVF3O2ayrN/p2u5UO9IBmQGgd4XgYHLcdCHr8zMTi7EFwH1NPlWsPs/Cp+RDSe6G/nxUqwA9fa2NyVfBZ4APxp+isAB9sl+vFgt9S/eA5trM/nPmtzA6pAndwybDH+Cj0a4HqxPpKgVUcge7WrkJ7I02Qt8VUHs6y95bpfqaXxIaMTwWwS3CD5NpJ3L31wWT77M2vk4GZF4ayFm8a6yNPkSeO//encI/d0z8zeyNLkHbKnyxXAJmAI6lvr0+7LWVmEjR5VPwmG01pi/nbXHozS9MHxdAqaB9U1Hj1vRTfA72Hua+kOLsdYifFG0tEaE4uMFgMylElCaUppTnofgb0BzFmsie7eIhgIeNj4v6VXMjmXtntREe9sHlj9tivta4JcCf1ZrzG3POpIhmT8C/kHobkuSrAt5/r2h5x8PfFATnfFmFxqvfgY+AlbJ7qtNz22bSJNjoTJYgypfZu4T+STWWeB3An3VIGXt8WGkz20GJC6UiYW9vyVSKtgYoFNwALho+4qkcxZvdz/KLy2OcpYmXuErywld3YxPIcZrj/JqHp5ZpiyNz4COrAD6FXSq1pg989wyLQj1NO6NFL2B/bqhX1AYXcNhrDVp+27Dg6dLu/F30V+TSu1LwjhwUwAAAABJRU5ErkJggg==';
        tgTitle.prepend('<img class=\"user_emergency\" style=\"\" src=\"' + imagebase64 + '\"/>');
    }
}",
  "beforeHide": "function(_context, _cfg) { }"
}
```

3、新的执行主页

含有 “是否紧急” 作业组属性，且属性值为“9fe21234-78df-4521-8744-802d50e40bd1”的作业组

作业组名称前面显示一个指定的图片

注：属性值如果是列表，则需要使用列表项ID；要插入的图标必须转化为base64

```
{
  "name": "executeOverview",
  "beforeShow": "function(_context, _cfg) {}",
  "afterShow": "function(_context, _cfg) {
var daAccess = new DAAccess();
    var daProperty = daAccess.GetDA(SyncEntity.TaskGroupProperty);
    daProperty.GetTaskGroupIDsByPropertyValue('是否紧急', '9fe21234-78df-4521-8744-802d50e40bd1', function (success, ids) {
        if (success && ids && ids.length > 0) {
            var tgs = $('.mainTaskGroup');
            var imagebase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAk9JREFUOE+Fk01oFlcUhp93kpkIBVcqXZgJoZZ80YWm6aILIdFN/QGhtLpIiy4s4k6brrqpSpONYnFRaAOCQsFFpS5qK7Yu4g/aEgRDoXwTgxK/hBZcFbGFTDL3bWf65cdq07u6vOech3vee454wZnsiHsKeE3WVqzC8nVF3O2ayrN/p2u5UO9IBmQGgd4XgYHLcdCHr8zMTi7EFwH1NPlWsPs/Cp+RDSe6G/nxUqwA9fa2NyVfBZ4APxp+isAB9sl+vFgt9S/eA5trM/nPmtzA6pAndwybDH+Cj0a4HqxPpKgVUcge7WrkJ7I02Qt8VUHs6y95bpfqaXxIaMTwWwS3CD5NpJ3L31wWT77M2vk4GZF4ayFm8a6yNPkSeO//encI/d0z8zeyNLkHbKnyxXAJmAI6lvr0+7LWVmEjR5VPwmG01pi/nbXHozS9MHxdAqaB9U1Hj1vRTfA72Hua+kOLsdYifFG0tEaE4uMFgMylElCaUppTnofgb0BzFmsie7eIhgIeNj4v6VXMjmXtntREe9sHlj9tivta4JcCf1ZrzG3POpIhmT8C/kHobkuSrAt5/r2h5x8PfFATnfFmFxqvfgY+AlbJ7qtNz22bSJNjoTJYgypfZu4T+STWWeB3An3VIGXt8WGkz20GJC6UiYW9vyVSKtgYoFNwALho+4qkcxZvdz/KLy2OcpYmXuErywld3YxPIcZrj/JqHp5ZpiyNz4COrAD6FXSq1pg989wyLQj1NO6NFL2B/bqhX1AYXcNhrDVp+27Dg6dLu/F30V+TSu1LwjhwUwAAAABJRU5ErkJggg==';
            _.each(tgs, function (_tgDom) {
                var tg = $(_tgDom).data('taskgroup');
                if (tg) {
                    var tgTitle = $('h4', _tgDom);
                    $('.user_emergency', tgTitle).remove();
                    var find = _.find(ids, function (_id) { return _id == tg.ID; });
                    if (find) {
                        tgTitle.prepend('<img class=\"user_emergency\" style=\"\" src=\"' + imagebase64 + '\"/>');
                    }
                }
            });
        }
        else {
            $('.user_emergency').remove();
        }
    });
   }",
  "beforeHide": "function(_context, _cfg) {  }"
}
```

  <img alt=" " src={useBaseUrl('docimg/zdyym41001.png')} />

* 效果如下：

  * 主页

    <img alt=" " src={useBaseUrl('docimg/zdyym41002.png')} />

  * 执行页

    <img alt=" " src={useBaseUrl('docimg/zdyym41003.png')} />

  * 新的执行主页

    <img alt=" " src={useBaseUrl('docimg/zdyym41004.png')} />

### PBIN3721：报表支持把条件直接设置到工具条上

* 报表类的页面功能增强，报表的列排序修改为样式设置，点击可以设置允许作为条件保存到工具条上，就是可以将查询条件中的配置直接设置显示到页面上。

  <img alt=" " src={useBaseUrl('docimg/bbyssz4101.png')} />

### PBIN3722：Web图片类型的作业组属性支持缩略图显示

* web端作业组属性文件和图片类的显示优化，文件类按照格式显示图标，图片类以缩略图形式显示，点击可以直接打开新标签页查看。

  <img alt=" " src={useBaseUrl('docimg/zyzsx4101.png')} />

### PBIN3723：EOC作业树图片预览时支持缩放

* EOC作业树的图片预览功能优化，点击作业项逻辑图片为全屏显示，并支持放大和缩小,以及显示原图。

* 未优化前EOC作业树页面的图片预览，点击后悬浮预览

  <img alt=" " src={useBaseUrl('docimg/eoczuoyeshu4102.png')} />

* 预览功能优化后，点击则在浏览器内全屏显示，右上角按钮分别为缩小，放大，以原图的像素大小显示，关闭预览。

  <img alt=" " src={useBaseUrl('docimg/eoczuoyeshu4101.png')} />

### PBIN3724：EOC所有三个点的链接地方改成详情

* EOC端显示优化，链接显示为三个点的地方，如作业树中json字符串格式的作业项，作业组属性、资产属性中的json字符串等，统一改为显示详情二字。

  <img alt=" " src={useBaseUrl('docimg/eocxiangqing4101.png')} />

    <img alt=" " src={useBaseUrl('docimg/eocxiangqing4102.png')} />

### PBIN3725：EOC新建或编辑物料时，物料号和物料名有重复直接提示

* EOC库存功能优化，在物料表中新建或编辑物料时，输入物料号和物料名时，有重复的数据会直接进行提示，不需要点击时确定再提示。

  <img alt=" " src={useBaseUrl('docimg/wuliao4101.png')} />

### PBIN3726：资产总览活动作业和历史作业支持例外等级筛选

* EOC资产总览功能增强，在资产总览的活动作业和历史作业中，增加例外等级的筛选，可以将符合例外条件的作业筛选出来。

  <img alt=" " src={useBaseUrl('docimg/zichanliwai4101.png')} />

### PBIN3727：排班表支持批量删除

* EOC排班表功能优化，现在支持将当前视图内当前时间后的所有排班批量删除。如图选择为周视图，点击批量删除，删除的是此周中所有开始时间大于当前时间的排班。

  <img alt=" " src={useBaseUrl('docimg/eocpaiban4101.png')} />

### PBIN3728：记录报表跳转前选中行，返回时自动选中

* EOC报表体验优化，以活动中作业组报表为例，选中某一行后，点击超链接如作业组名称或人员等，进入作业树页面或人员总览页面后，再点击浏览器的返回，回到活动中作业组报表页面时，会自动选中跳转前的选中行。

  <img alt=" " src={useBaseUrl('docimg/baobiaotiaozhuan4101.png')} />

### PBIN3770：增加启用更新资产属性消息的配置

* SMC系统设置里面，启动资产属性消息

 <img alt=" " src={useBaseUrl('docimg/资产属性1.png')} />

* EOC选择资产总览

<img alt=" " src={useBaseUrl('docimg/资产属性2.jpg')} />

* 选择具体的资产

 <img alt=" " src={useBaseUrl('docimg/资产属性3.jpg')} />

* 修改完之后，最新动态那里有个小气泡

  <img alt=" " src={useBaseUrl('docimg/资产属性4.png')} />

### PBIN3771：增加批量更新资产属性的接口，同时指定是否产生变化消息

* RESTful API中新增加了批量更新资产属性的接口，可用于批量更新资产属性，同时可以指定批量更新后是否能产生其变化的消息。当SMC系统设置里面，启动资产属性消息后，此接口也指定了会产生变化消息，那么在资产总览中才会有此接口操作的动态更新。

  <img alt=" " src={useBaseUrl('docimg/shuxingpiliangapi4101.png')} />

### PBIN3772：所有内置报表、库存等支持配置为另外的扩展功能，从而实现相同功能定义不同的隐藏列和列显示名

* EOC扩展功能增强，所有内置的报表、库存等，都可以在系统扩展管理中，配置为自定义报表。在个性设置中可以为其设置不同的隐藏列和列的显示名，从而区别于原内置报表，实现不同场景下的需求。

* 以物料表为例：

  <img alt=" " src={useBaseUrl('docimg/eockuozhan4101.png')} />

  <img alt=" " src={useBaseUrl('docimg/eockuozhan4102.png')} />

  <img alt=" " src={useBaseUrl('docimg/eockuozhan4103.png')} />

### PBIN3775：支持下载作业组特殊视图的API

* RESTful API中新增加了下载作业组特殊视图的API，通过此接口，可以获取作业组特殊视图进行下载

  <img alt=" " src={useBaseUrl('docimg/shituapi4101.png')} />

### PBIN3804：EOC布局调整

* EOC布局调整，由于菜单越来越多，为了更有观赏性和画面感，将原页面的留白进行了减小，右上角展开/收起按钮也进行了优化显示。

* 优化前的布局：

  <img alt=" " src={useBaseUrl('docimg/eocbuju4101.png')} />

* 优化后的布局：

  <img alt=" " src={useBaseUrl('docimg/eocbuju4102.png')} />

### PBIN3828：作业组属性支持审核完成前脚本

* 在SDC作业组属性更多设置中，增加了一项审核完成前脚本。在EOC或终端上，选择批准等审核行为点击确定后，会运行此功能中的脚本，当审核活动的权限为不可见或可查看时，不运行此脚本。

  <img alt=" " src={useBaseUrl('docimg/shwcqjb4101.png')} />

* 举例图中审核完成前脚本的作用：存在一个作业组属性“字符串”，在审核时为必填，当审核行为是退回时，脚本运行检查到行为是退回，可以忽略此项必填直接退回，当审核行为是批准时，脚本检查到行为是批准，则会要求必填不可空白。此脚本EOC端和终端都适用。

  <img alt=" " src={useBaseUrl('docimg/shwcqjb4102.png')} />

  <img alt=" " src={useBaseUrl('docimg/shwcqjb4103.png')} />

* 脚本例子

```
// operateType 为'0'表示批准，为'1'表示退回;activityEntityName为活动名
if (operateType == '1' && activityEntityName == '审核') { // 审核1的退回情况下,必填的作业组属性'字符串'不需要必填
    if (window.SysCommon && !window.SysCommon.IsMobileDevices()) { // EOC
        var isNotValidateRequired = false;
        var needValidates = $('#' + contextID).find('[class*=validate]');
        _.each(needValidates, function (_item) {
            var classNameList = $(_item).attr('class').split(' ');
            var find = _.find(classNameList, function (__item) { return __item.indexOf('validate[required') > -1 });
            if (find) {
                $(_item).removeClass(find);
                isNotValidateRequired = true;
            }
        })
        if (isNotValidateRequired)
            $('#' + contextID).attr('noRequired', 'true');
        // json字符串和多选列表只写：$('#' + contextID).attr('noRequired', 'true');
    } else { // 终端
        var obj = ScriptEngine.Context.dicProperty2InputBox['字符串'];
        if (obj) {
            obj.InputBox.task.DataExtent.NotAllowedNullIsValid = false;
        }
    }
    return true;
} else {
    return true;
}
```

### PBIN3833：产品内部扩展统一部署和运行

* 在部署工具中，企业运营中心的部署中新增加了包含终端扩展和包含关系引擎两项，可自由选择在部署企业运营中心时是否包含

  <img alt=" " src={useBaseUrl('docimg/bushu4101.png')} />

* 选择包含并部署后，在iis中EOC的目录中将增加此两项

  <img alt=" " src={useBaseUrl('docimg/bushu4103.png')} />

* 如需使用，EOC上系统扩展管理-自定义报表中，选择内置扩展，勾选关系引擎编辑器，添加，即可使用关联关系页面

  <img alt=" " src={useBaseUrl('docimg/bushu4102.png')} />

  <img alt=" " src={useBaseUrl('docimg/bushu4104.png')} />

* 在终端自定义查询中，可以选择相应的终端扩展添加

  <img alt=" " src={useBaseUrl('docimg/bushu4105.png')} />

### PBIN3846：终端同步增加进度条和完成百分比显示

* 终端同步界面，增加了同步的进度条和完成百分比显示，从而让使用人员更清晰的知晓同步的进度

  <img alt=" " src={useBaseUrl('docimg/tongbu4101.png')} />

### PBIN3863：资产属性支持配置不保存历史

* SDC资产属性中，新增了不保存历史的配置，当勾选上不保存历史后，该资产属性的值将不再保存进历史数据。

  <img alt=" " src={useBaseUrl('docimg/lishi4101.png')} />

* 在EOC端资产总览的趋势中和资产属性历史报表中也不会有记录，勾选此配置前的记录仍然保留。

  <img alt=" " src={useBaseUrl('docimg/lishi4102.png')} />

  <img alt=" " src={useBaseUrl('docimg/lishi4103.png')} />
